name: GitHub Actions Demo Development
on: 
    push:
        branches:
            - development
        paths:
            - 'release/snapshot/snapshot.bom'
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v2
        with: 
            fetch-depth: '0'
      - name: Checking Variable
        run: |
          bom=`echo release/snapshot/snapshot.bom`
          echo "BOM_FILE=$bom" >> $GITHUB_ENV
          echo "WORK_DIR=`pwd`" >> $GITHUB_ENV
          Tag_Name="SD."
          echo $bom
          echo $GITHUB_ENV
          BUILD_NO=10001
          echo $BUILD_NO
          Latest_Tag=$(git tag --sort creatordate -l $Tag_Name* | tail -n1)
          if [ -z "$Latest_Tag" ];
          then
              BUILD_NO=10001
              Tag_Name=""$Tag_Name"10001"
          else
              Tag_Name=$(perl -pe 's/(\d+)(?!.*\d+)/$1+1/e' <<< $Latest_Tag)
              BUILD_NO=`echo "$Tag_Name" | awk -F. '{print $NF}'`
          fi
          echo "Build Number is: $BUILD_NO"
          echo "RELEASE_NO=$BUILD_NO" >> $GITHUB_ENV
          echo RELEASE_NO
          echo BOM_FILE

      
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
          echo "üçè This job's status is ${{ job.status }}."
